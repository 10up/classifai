(()=>{function t(t,n){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var a,i,r=[],o=!0,c=!1;try{for(n=n.call(t);!(o=(a=n.next()).done)&&(r.push(a.value),!e||r.length!==e);o=!0);}catch(t){c=!0,i=t}finally{try{o||null==n.return||n.return()}finally{if(c)throw i}}return r}}(t,n)||function(t,n){if(t){if("string"==typeof t)return e(t,n);var a=Object.prototype.toString.call(t).slice(8,-1);return"Object"===a&&t.constructor&&(a=t.constructor.name),"Map"===a||"Set"===a?Array.from(t):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?e(t,n):void 0}}(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function e(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,a=new Array(e);n<e;n++)a[n]=t[n];return a}var n,a,i,r,o;n=jQuery,a=wp.i18n.__,i=window.lodash.get,r=function(e){var n=e.button,r=e.endpoint,o=e.callback,c=void 0!==o&&o,s=n.getAttribute("data-id"),l=t(n.parentNode.getElementsByClassName("spinner"),1)[0],d=t(n.parentNode.getElementsByClassName("error"),1)[0],u="".concat(r).concat(s);n.setAttribute("disabled","disabled"),l.style.display="inline-block",l.classList.add("is-active"),d.style.display="none",wp.apiRequest({path:u}).then((function(t){n.removeAttribute("disabled"),l.style.display="none",l.classList.remove("is-active"),n.textContent=a("Rescan","classifai"),c&&c(t)}),(function(t){var e=i(t,"responseJSON",{code:"unknown_error",message:a("An unknown error occurred.","classifai")});l.style.display="none",l.classList.remove("is-active"),n.removeAttribute("disabled"),n.textContent=a("Rescan","classifai"),d.style.display="inline-block",d.textContent="Error: ".concat(e.message)}))},o=function(){var t=document.getElementById("classifai-rescan-alt-tags"),e=document.getElementById("classifai-rescan-image-tags"),n=document.getElementById("classifai-rescan-ocr"),i=document.getElementById("classifai-rescan-smart-crop"),o=document.getElementById("classifai-rescan-pdf");t&&t.addEventListener("click",(function(t){return r({button:t.target,endpoint:"/classifai/v1/alt-tags/",callback:function(t){if(t){var e,n=null!==(e=document.getElementById("attachment-details-two-column-alt-text"))&&void 0!==e?e:document.getElementById("attachment-details-alt-text");n&&(n.value=t)}}})})),e&&e.addEventListener("click",(function(t){return r({button:t.target,endpoint:"/classifai/v1/image-tags/"})})),n&&n.addEventListener("click",(function(t){return r({button:t.target,endpoint:"/classifai/v1/ocr/",callback:function(t){if(t){var e,n=null!==(e=document.getElementById("attachment-details-two-column-description"))&&void 0!==e?e:document.getElementById("attachment-details-description");n&&(n.value=t)}}})})),i&&i.addEventListener("click",(function(t){return r({button:t.target,endpoint:"/classifai/v1/smart-crop/"})})),o&&o.addEventListener("click",(function(t){var e=t.target.getAttribute("data-id");wp.apiRequest({path:"/classifai/v1/read-pdf/".concat(e)}),t.target.setAttribute("disabled","disabled"),t.target.textContent=a("Read API requested!","classifai")}))},n(document).ready((function(){wp.media&&wp.media.view.Modal.prototype.on("open",(function(){wp.media.frame.on("selection:toggle",o)})),wp.media.frame&&wp.media.frame.on("edit:attachment",o)}))})();