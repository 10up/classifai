(()=>{"use strict";function e(e){document.querySelectorAll(`#${e} .classifai-send-reward`).forEach((function(e){e.addEventListener("click",(function(e){e.preventDefault();const t=this.getAttribute("data-eventid"),n=this.getAttribute("data-rewarded"),r=`${classifai_personalizer_params?.reward_endpoint}`;fetch(r.replace("{eventId}",t),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({rewarded:n})}).catch((e=>{console.error(e)})),window.location=this.href}))}))}document.addEventListener("DOMContentLoaded",(function(){document.querySelectorAll(".classifai-recommended-block-wrap").forEach((function(t){const n=t.getAttribute("id"),r=function(e){const t=window.sessionStorage.getItem(e);if(null!==t){const e=JSON.parse(t);if(new Date(e.expiresAt)>new Date)return e.value}return null}(n);if(null!==r)return t.innerHTML=r,void e(n);const a=t.getAttribute("data-attr_key"),o=classifai_personalizer_params?.ajax_url,i=JSON.parse(document.getElementById(`attributes-${a}`).textContent);i.action="classifai_render_recommended_content",i.security=classifai_personalizer_params?.ajax_nonce;const c=new URLSearchParams(i);i.taxQuery&&Object.keys(i.taxQuery)&&(c.delete("taxQuery"),Object.keys(i.taxQuery).forEach((e=>{i.taxQuery[e]&&i.taxQuery[e].forEach((t=>{c.append(`taxQuery[${e}][]`,t)}))}))),fetch(o,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},body:c}).then((e=>{if(!e.ok)throw new Error("Something went wrong");return e.text()})).then((t=>{var r,a;t&&(r=n,a=t,60,window.sessionStorage.setItem(r,JSON.stringify({expiresAt:new Date((new Date).getTime()+36e5),value:a}))),document.getElementById(n).innerHTML=t,e(n)})).catch((e=>{document.getElementById(n).innerHTML="",console.error(e)}))}))}))})();